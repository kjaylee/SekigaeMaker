<!DOCTYPE html>
<html>
  <head>
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
  </head>
  <body>

    <div id="app">
      <v-app>
        <v-container>
          <v-row>
            <v-col>
              <h1 class="text-center">席替えメーカー</h1>
            </v-col>
          </v-row>

          <v-row>
            <!-- 座席テーブル -->
            <v-col cols="7" style="background-color: #FFCDD2">
              <div id="seatArrange">
                <li v-for="( seats, indexRow ) in seatsTable">
                  <input type="text" v-for="( seat, indexCol ) in seats" class="seat" :class="getColor( seatsTable[indexRow][indexCol] )" @input="activeSeat( indexRow, indexCol ); countSeats()"
                  :key="indexRow.toString() + indexCol.toString()">
                </li>
              </div>
            </v-col>

            <v-row>
              <!-- よこの座席数入力フォーム -->
              <v-col cols="auto" style="background-color: #F8BBD0">
                <v-select :items="seatsOptionsX" label="よこの座席数" outlined　v-model.number="seatsSizeX" @change="makeTable()"></v-select>
              </v-col>

              <!-- たての座席数入力フォーム -->
              <v-col cols="auto" style="background-color: #E1BEE7">
                <v-select :items="seatsOptionsY" label="たての座席数" outlined　v-model.number="seatsSizeY" @change="makeTable()"></v-select>
              </v-col>


            </v-row>
            現在の座席数：{{ seats_num }}
          </v-row>
        </v-container>
      </v-app>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>

    <script>
      const app = new Vue({
        el: "#app",
        vuetify: new Vuetify(),
        data: {
          seatsSizeY: 6, // デフォルト値は6
          seatsSizeX: 6, // デフォルト値は6
          seatsTable: [], // 座席テーブル 座れない座席 -1, 座れる座席 1
          seats_num: 0, // 有効な座席数
          seatsOptionsX: [2,3,4,5,6,7,8],
          seatsOptionsY: [2,3,4,5,6,7,8]
        },
        methods: {
          getColor(seat) { // 座席の種類に応じた色を返す
            if(seat === -1)  return 'gray'
            else if (seat === 1) return 'green'
          },
          activeSeat(indexRow, indexCol) { // 引数で受け取った座席の有効、無効を切り替える
            this.seatsTable[indexRow].splice(indexCol, 1, 1)
            console.log(`${indexRow}${indexCol}が入力されたよー`);
            console.log(`${this.seatsTable[indexRow][indexCol]}`);
          },
          makeTable() { // seatsTableを作成
            this.seatsTable = []
            for(let i = 0; i < this.seatsSizeY; i++) {
              this.seatsTable.push( Array(this.seatsSizeX).fill(-1) ) // すべての席に名前が未入力な状態でテーブルを作成
            }
            this.countSeats();
            console.log(`${this.seatsSizeX}x${this.seatsSizeY}でmakeTableを実行したよー`);
          },
          countSeats() { // 有効な座席数をカウント
            this.seats_num = 0;
            this.seatsTable.forEach(seats => {
              seats.forEach(seat => {
                if (seat === 1) this.seats_num += 1
              })
            })
            console.log(this.seats_num);
          }
        },
        mounted() {
          this.makeTable() // 最初にseatsTableを作成
        }
      });
    </script>
  </body>
</html>


<style>
  li {
    text-align: center;
	  list-style: none;
	  height: 80px;
  }
  .green {
    background: mediumaquamarine;
  }
  .gray{
    background: gainsboro;
  }
  .seat{
    height: 80px;
    width: 80px;
    display: inline-block;
    border: 1px solid white;
    box-sizing: border-box;
    text-align: center;
  }
  .input {
    text-align: center;
  }
</style>